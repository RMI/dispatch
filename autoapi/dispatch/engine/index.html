<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex.html"><link rel="search" title="Search" href="../../../search.html"><link rel="next" title="dispatch.helpers" href="../helpers/index.html"><link rel="prev" title="dispatch" href="../index.html">
        <link rel="prefetch" href="../../../_static/Small_PNG-RMI_logo_PrimaryUse.PNG" as="image">
        <link rel="prefetch" href="../../../_static/Small_PNG-RMI_logo_PrimaryUse_White_Horizontal.PNG" as="image">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.12.19 -->
        <title>dispatch.engine - Dispatch 0.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=b1990d62" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Dispatch 0.6 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/Small_PNG-RMI_logo_PrimaryUse.PNG" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/Small_PNG-RMI_logo_PrimaryUse_White_Horizontal.PNG" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Dispatch 0.6 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../approach.html">Approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">API Reference</a><input aria-label="Toggle navigation of API Reference" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index.html">dispatch</a><input aria-label="Toggle navigation of dispatch" checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">dispatch.engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../helpers/index.html">dispatch.helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../metadata/index.html">dispatch.metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/index.html">dispatch.model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../LICENSE.html">Licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code_of_conduct.html">Code of Conduct</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/rmi/dispatch/blob/main/docs/autoapi/dispatch/engine/index.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/rmi/dispatch/edit/main/docs/autoapi/dispatch/engine/index.rst" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-dispatch.engine">
<span id="dispatch-engine"></span><h1>dispatch.engine<a class="headerlink" href="#module-dispatch.engine" title="Link to this heading">¶</a></h1>
<p>Dispatch engine.</p>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dispatch.engine.dispatch_engine_auto" title="dispatch.engine.dispatch_engine_auto"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dispatch_engine_auto</span></code></a>(net_load, hr_to_cost_idx, ...[, ...])</p></td>
<td><p>Autotune <code class="docutils literal notranslate"><span class="pre">dynamic_reserve_coeff</span></code> in <a class="reference internal" href="#dispatch.engine.dispatch_engine" title="dispatch.engine.dispatch_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">dispatch_engine()</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dispatch.engine.choose_best_coefficient" title="dispatch.engine.choose_best_coefficient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">choose_best_coefficient</span></code></a>(comparison)</p></td>
<td><p>Select the optimal combination of deficit and curtailment.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dispatch.engine.dispatch_engine" title="dispatch.engine.dispatch_engine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dispatch_engine</span></code></a>(net_load, hr_to_cost_idx, ...)</p></td>
<td><p>Dispatch engine that can be compiled with <a class="reference external" href="https://numba.readthedocs.io/en/stable/reference/jit-compilation.html#numba.jit" title="(in Numba v0+untagged.740)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba.jit()</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dispatch.engine.compare" title="dispatch.engine.compare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare</span></code></a>(a, b, msg)</p></td>
<td><p>Check that all entries in a are &gt;= to the corresponding value in b.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dispatch.engine.dynamic_reserve" title="dispatch.engine.dynamic_reserve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dynamic_reserve</span></code></a>(hr, reserve, net_load, coeff)</p></td>
<td><p>Adjust storage reserve based on 24hr net load.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dispatch.engine.adjust_for_storage_reserve" title="dispatch.engine.adjust_for_storage_reserve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">adjust_for_storage_reserve</span></code></a>(state_of_charge, mw, ...)</p></td>
<td><p>Adjustment to deficit to restore or use storage reserve.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dispatch.engine.discharge_storage" title="dispatch.engine.discharge_storage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">discharge_storage</span></code></a>(desired_mw, state_of_charge, mw, ...)</p></td>
<td><p>Calculations for discharging storage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dispatch.engine.calculate_generator_output" title="dispatch.engine.calculate_generator_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_generator_output</span></code></a>(desired_mw, max_mw, ...[, ...])</p></td>
<td><p>Determine period output for a generator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dispatch.engine.make_rank_arrays" title="dispatch.engine.make_rank_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_rank_arrays</span></code></a>(marginal_cost, startup_cost)</p></td>
<td><p>Turn cost arrays into rank arrays.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dispatch.engine.charge_storage" title="dispatch.engine.charge_storage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">charge_storage</span></code></a>(deficit, state_of_charge, dc_charge, ...)</p></td>
<td><p>Calculations for charging storage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dispatch.engine.validate_inputs" title="dispatch.engine.validate_inputs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">validate_inputs</span></code></a>(net_load, hr_to_cost_idx, ...)</p></td>
<td><p>Validate shape of inputs.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.dispatch_engine_auto">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">dispatch_engine_auto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net_load</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hr_to_cost_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_dispatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatchable_ramp_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatchable_startup_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatchable_marginal_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatchable_min_uptime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_charge_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_hrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_charge_eff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_discharge_eff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_op_hour</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_dc_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_reserve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_reserve_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginal_for_startup_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#dispatch_engine_auto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.dispatch_engine_auto" title="Link to this definition">¶</a></dt>
<dd><p>Autotune <code class="docutils literal notranslate"><span class="pre">dynamic_reserve_coeff</span></code> in <a class="reference internal" href="#dispatch.engine.dispatch_engine" title="dispatch.engine.dispatch_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">dispatch_engine()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>net_load</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – net load, as in net of RE generation, negative net load means
excess renewables</p></li>
<li><p><strong>hr_to_cost_idx</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – an array that contains for each hour, the index of the correct
column in <code class="docutils literal notranslate"><span class="pre">dispatchable_marginal_cost</span></code> that contains cost data for that
hour</p></li>
<li><p><strong>historical_dispatch</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – historic generator dispatch, acts as an hourly upper
constraint on this dispatch</p></li>
<li><p><strong>dispatchable_ramp_mw</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – max one hour ramp in MW</p></li>
<li><p><strong>dispatchable_startup_cost</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – startup cost in $ for each dispatchable generator</p></li>
<li><p><strong>dispatchable_marginal_cost</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – annual marginal cost for each dispatchable
generator in $/MWh rows are generators and columns are years</p></li>
<li><p><strong>dispatchable_min_uptime</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – minimum hrs a generator must operate before its
output can be reduced</p></li>
<li><p><strong>storage_mw</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – max discharge rate for storage in MW</p></li>
<li><p><strong>storage_charge_mw</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – max charge rate for storage in MW</p></li>
<li><p><strong>storage_hrs</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – duration of storage</p></li>
<li><p><strong>storage_charge_eff</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – storage charge efficiency</p></li>
<li><p><strong>storage_discharge_eff</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – storage discharge efficiency</p></li>
<li><p><strong>storage_op_hour</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – first hour in which storage is available, i.e. the index of
the operating date</p></li>
<li><p><strong>storage_dc_charge</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – an array whose columns match each storage facility, and a
row for each hour representing how much energy would be curtailed at an
attached renewable facility because it exceeds the system’s inverter. This
then represents how much the storage in an RE+Storage facility could be
charged by otherwise curtailed energy when ilr&gt;1.</p></li>
<li><p><strong>storage_reserve</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – portion of a storage facility’s SOC that will be held in
reserve until after dispatchable resource startup.</p></li>
<li><p><strong>dynamic_reserve_coeff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – coefficient passed to
<a class="reference internal" href="#dispatch.engine.dynamic_reserve" title="dispatch.engine.dynamic_reserve"><code class="xref py py-func docutils literal notranslate"><span class="pre">dispatch.engine.dynamic_reserve()</span></code></a> to use in exponential function.
<code class="docutils literal notranslate"><span class="pre">-10.0</span></code> means autotune this parameter.</p></li>
<li><p><strong>marginal_for_startup_rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – if True, rather than using
<code class="docutils literal notranslate"><span class="pre">dispatchable_startup_cost</span></code> to order generators for startup, use marginal
cost rank</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>redispatch</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) - new hourly dispatch</p></li>
<li><p><strong>storage</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) - hourly charge, discharge, and state
of charge data</p></li>
<li><p><strong>system_level</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) - hourly deficit, dirty charge,
and total curtailment dat</p></li>
<li><p><strong>starts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) - count of starts for each generator in
each year</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.choose_best_coefficient">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">choose_best_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comparison</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#choose_best_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.choose_best_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>Select the optimal combination of deficit and curtailment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>comparison</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
<p>Returns: index of the optimal case</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.dispatch_engine">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">dispatch_engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net_load</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hr_to_cost_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_dispatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatchable_ramp_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatchable_startup_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatchable_marginal_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatchable_min_uptime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_charge_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_hrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_charge_eff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_discharge_eff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_op_hour</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_dc_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_reserve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_reserve_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginal_for_startup_rank</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#dispatch_engine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.dispatch_engine" title="Link to this definition">¶</a></dt>
<dd><p>Dispatch engine that can be compiled with <a class="reference external" href="https://numba.readthedocs.io/en/stable/reference/jit-compilation.html#numba.jit" title="(in Numba v0+untagged.740)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba.jit()</span></code></a>.</p>
<p>For each hour…</p>
<ol class="arabic simple">
<li><p>first iterate through operating generators</p></li>
<li><p>then charge/discharge storage</p></li>
<li><p>if there is still a deficit, iterate through non-operating generators
and turn them on if required</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>net_load</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – net load, as in net of RE generation, negative net load means
excess renewables</p></li>
<li><p><strong>hr_to_cost_idx</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – an array that contains for each hour, the index of the correct
column in <code class="docutils literal notranslate"><span class="pre">dispatchable_marginal_cost</span></code> that contains cost data for that
hour</p></li>
<li><p><strong>historical_dispatch</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – historic generator dispatch, acts as an hourly upper
constraint on this dispatch</p></li>
<li><p><strong>dispatchable_ramp_mw</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – max one hour ramp in MW</p></li>
<li><p><strong>dispatchable_startup_cost</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – startup cost in $ for each dispatchable generator</p></li>
<li><p><strong>dispatchable_marginal_cost</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – annual marginal cost for each dispatchable
generator in $/MWh rows are generators and columns are years</p></li>
<li><p><strong>dispatchable_min_uptime</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – minimum hrs a generator must operate before its
output can be reduced</p></li>
<li><p><strong>storage_mw</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – max discharge rate for storage in MW</p></li>
<li><p><strong>storage_charge_mw</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – max charge rate for storage in MW</p></li>
<li><p><strong>storage_hrs</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – duration of storage</p></li>
<li><p><strong>storage_charge_eff</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – storage charge efficiency</p></li>
<li><p><strong>storage_discharge_eff</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – storage discharge efficiency</p></li>
<li><p><strong>storage_op_hour</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – first hour in which storage is available, i.e. the index of
the operating date</p></li>
<li><p><strong>storage_dc_charge</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – an array whose columns match each storage facility, and a
row for each hour representing how much energy would be curtailed at an
attached renewable facility because it exceeds the system’s inverter. This
then represents how much the storage in an RE+Storage facility could be
charged by otherwise curtailed energy when ilr&gt;1.</p></li>
<li><p><strong>storage_reserve</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – portion of a storage facility’s SOC that will be held in
reserve until after dispatchable resource startup.</p></li>
<li><p><strong>dynamic_reserve_coeff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – coefficient passed to
<a class="reference internal" href="#dispatch.engine.dynamic_reserve" title="dispatch.engine.dynamic_reserve"><code class="xref py py-func docutils literal notranslate"><span class="pre">dispatch.engine.dynamic_reserve()</span></code></a> to use in exponential function.</p></li>
<li><p><strong>marginal_for_startup_rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – if True, rather than using
<code class="docutils literal notranslate"><span class="pre">dispatchable_startup_cost</span></code> to order generators for startup, use marginal
cost rank</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>redispatch</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) - new hourly dispatch</p></li>
<li><p><strong>storage</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) - hourly charge, discharge, and state
of charge data</p></li>
<li><p><strong>system_level</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) - hourly deficit, dirty charge,
and total curtailment data</p></li>
<li><p><strong>starts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) - count of starts for each generator in
each year</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.compare">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.compare" title="Link to this definition">¶</a></dt>
<dd><p>Check that all entries in a are &gt;= to the corresponding value in b.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.dynamic_reserve">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">dynamic_reserve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reserve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">net_load</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#dynamic_reserve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.dynamic_reserve" title="Link to this definition">¶</a></dt>
<dd><p>Adjust storage reserve based on 24hr net load.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – hour index</p></li>
<li><p><strong>reserve</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – storage reserve defaults</p></li>
<li><p><strong>net_load</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – net load profile</p></li>
<li><p><strong>coeff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – coefficient in exponential</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a></p>
</dd>
</dl>
<div class="math-wrapper docutils container" id="equation-reserve">
<div class="math notranslate nohighlight" id="equation-reserve">
<span class="eqno">(1)<a class="headerlink" href="#equation-reserve" title="Link to this equation">¶</a></span>\[ \begin{align}\begin{aligned}   ramp &amp;= \frac{max(load_{h+1}, ..., load_{h+24})}{load_h} - 1\\   reserve &amp;= 1 - e^{-coeff \times ramp}\end{aligned}\end{align} \]</div>
</div>
<p>Returns: adjusted reserves</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.adjust_for_storage_reserve">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">adjust_for_storage_reserve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_of_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reserve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_state_of_charge</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#adjust_for_storage_reserve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.adjust_for_storage_reserve" title="Link to this definition">¶</a></dt>
<dd><p>Adjustment to deficit to restore or use storage reserve.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_of_charge</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – state of charge before charging/discharging</p></li>
<li><p><strong>mw</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – storage power capacity</p></li>
<li><p><strong>reserve</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – target filling to this reserve level or allow discharging to
2x this level</p></li>
<li><p><strong>max_state_of_charge</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – storage energy capacity</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
<dl class="simple">
<dt>Returns: amount by which provisional deficit must be adjusted to use or replace</dt><dd><p>storage reserve</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.discharge_storage">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">discharge_storage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desired_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_of_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_state_of_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reserve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#discharge_storage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.discharge_storage" title="Link to this definition">¶</a></dt>
<dd><p>Calculations for discharging storage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>desired_mw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – amount of power we want from storage</p></li>
<li><p><strong>state_of_charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – state of charge before charging</p></li>
<li><p><strong>mw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – storage power capacity</p></li>
<li><p><strong>max_state_of_charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – storage energy capacity</p></li>
<li><p><strong>reserve</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – prevent discharge below this portion of <code class="docutils literal notranslate"><span class="pre">max_state_of_charge</span></code></p></li>
<li><p><strong>eff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – discharge efficiency of storage</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
<p>Returns: amount of storage discharge</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.calculate_generator_output">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">calculate_generator_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desired_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ramp_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_uptime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_uptime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#calculate_generator_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.calculate_generator_output" title="Link to this definition">¶</a></dt>
<dd><p>Determine period output for a generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>desired_mw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – desired generator output</p></li>
<li><p><strong>max_mw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – maximum output of generator this period</p></li>
<li><p><strong>previous_mw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – generator output in the previous period</p></li>
<li><p><strong>ramp_mw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – maximum one-period change in generator output in MW, up or down</p></li>
<li><p><strong>current_uptime</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – as of the end of the previous period, for how many periods
has the generator been operating</p></li>
<li><p><strong>min_uptime</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the minimum duration the generator must operate before its
output is reduced</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the generator for given period</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.make_rank_arrays">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">make_rank_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginal_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startup_cost</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#make_rank_arrays"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.make_rank_arrays" title="Link to this definition">¶</a></dt>
<dd><p>Turn cost arrays into rank arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marginal_cost</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – array of marginal costs</p></li>
<li><p><strong>startup_cost</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – array of startup cost</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>marginal_ranks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) - marginal rank array</p></li>
<li><p><strong>start_ranks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) - start rank array</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.charge_storage">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">charge_storage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deficit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_of_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_state_of_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#charge_storage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.charge_storage" title="Link to this definition">¶</a></dt>
<dd><p>Calculations for charging storage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deficit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – amount of charging possible from the grid</p></li>
<li><p><strong>state_of_charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – state of charge before charging</p></li>
<li><p><strong>dc_charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – power available from DC-coupled RE</p></li>
<li><p><strong>mw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – storage power capacity</p></li>
<li><p><strong>max_state_of_charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – storage energy capacity</p></li>
<li><p><strong>eff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – round-trip efficiency of storage</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple with the same organization of columns of internal <code class="docutils literal notranslate"><span class="pre">storage</span></code> in
<a class="reference internal" href="#dispatch.engine.dispatch_engine" title="dispatch.engine.dispatch_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">dispatch_engine()</span></code></a>.</p>
<ul class="simple">
<li><p><strong>charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) - total charge in the hour</p></li>
<li><p><strong>discharge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) - always 0.0, a placeholder</p></li>
<li><p><strong>soc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) - tate of charge after charging</p></li>
<li><p><strong>grid_charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -  portion of <code class="docutils literal notranslate"><span class="pre">charge</span></code> that came from
the grid</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dispatch.engine.validate_inputs">
<span class="sig-prename descclassname"><span class="pre">dispatch.engine.</span></span><span class="sig-name descname"><span class="pre">validate_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net_load</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hr_to_cost_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_dispatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ramp_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startup_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginal_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_charge_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_hrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_charge_eff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_discharge_eff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_dc_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_reserve</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dispatch/engine.html#validate_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dispatch.engine.validate_inputs" title="Link to this definition">¶</a></dt>
<dd><p>Validate shape of inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../helpers/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">dispatch.helpers</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">dispatch</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2026, RMI, CC-BY-4.0
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/rmi/dispatch" aria-label="GitHub">
            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
            </svg>
        </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">dispatch.engine</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#module-contents">Module Contents</a><ul>
<li><a class="reference internal" href="#dispatch.engine.dispatch_engine_auto"><code class="docutils literal notranslate"><span class="pre">dispatch_engine_auto()</span></code></a></li>
<li><a class="reference internal" href="#dispatch.engine.choose_best_coefficient"><code class="docutils literal notranslate"><span class="pre">choose_best_coefficient()</span></code></a></li>
<li><a class="reference internal" href="#dispatch.engine.dispatch_engine"><code class="docutils literal notranslate"><span class="pre">dispatch_engine()</span></code></a></li>
<li><a class="reference internal" href="#dispatch.engine.compare"><code class="docutils literal notranslate"><span class="pre">compare()</span></code></a></li>
<li><a class="reference internal" href="#dispatch.engine.dynamic_reserve"><code class="docutils literal notranslate"><span class="pre">dynamic_reserve()</span></code></a></li>
<li><a class="reference internal" href="#dispatch.engine.adjust_for_storage_reserve"><code class="docutils literal notranslate"><span class="pre">adjust_for_storage_reserve()</span></code></a></li>
<li><a class="reference internal" href="#dispatch.engine.discharge_storage"><code class="docutils literal notranslate"><span class="pre">discharge_storage()</span></code></a></li>
<li><a class="reference internal" href="#dispatch.engine.calculate_generator_output"><code class="docutils literal notranslate"><span class="pre">calculate_generator_output()</span></code></a></li>
<li><a class="reference internal" href="#dispatch.engine.make_rank_arrays"><code class="docutils literal notranslate"><span class="pre">make_rank_arrays()</span></code></a></li>
<li><a class="reference internal" href="#dispatch.engine.charge_storage"><code class="docutils literal notranslate"><span class="pre">charge_storage()</span></code></a></li>
<li><a class="reference internal" href="#dispatch.engine.validate_inputs"><code class="docutils literal notranslate"><span class="pre">validate_inputs()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=ba5251a8"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>